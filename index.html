
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Six Sections</title>
  <link href="https://fonts.cdnfonts.com/css/manofa" rel="stylesheet">
  <style>
    body {
      margin: 0;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      padding: 0;
      font-family: Arial, sans-serif;
      background: #000;
      transition: background-image 1s ease;
    }
    /* Responsive main sections */
    .main-section {
      max-width: 1200px;
      width: 95vw;
      margin-left: auto;
      margin-right: auto;
      box-sizing: border-box;
    }
    @media (min-width: 1400px) {
      .main-section {
        max-width: 1000px;
        width: 70vw;
      }
    }
    @media (min-width: 1800px) {
      .main-section {
        max-width: 900px;
        width: 55vw;
      }
    }
    @media (max-width: 900px) {
      .main-section {
        max-width: 98vw;
        width: 98vw;
      }
    }
    .title {
      font-family: 'Manofa', Arial, sans-serif;
      font-size: 2.6rem;
      font-weight: normal;
      letter-spacing: 0.04em;
      color: #fff;
      text-align: center;
      margin-top: 120px;
      margin-bottom: 18px;
      user-select: none;
      text-transform: uppercase;
    }
    .container {
      perspective: 1400px;
      position: relative;
      width: min(1200px, calc(100vw - 80px));
      height: 340px;
      margin: -32px auto 0 auto;
      padding: 8px;
    }
    .card {
      position: absolute;
      left: 60%;
      top: 50%;
      width: 312.5px;
      height: 406.25px;
      background: white;
      border-radius: 0;
      box-shadow: 0 12px 30px rgba(0,0,0,0.55);
      cursor: pointer;
      transition: transform 0.45s cubic-bezier(.2,.9,.2,1), opacity 0.28s ease, box-shadow 0.3s ease;
      transform-style: preserve-3d;
      transform-origin: center center;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
    }
    .card + .card { margin-left: 0; }
    /* Card stack positions - cleaned up for clarity */
    .card:nth-child(1)  { transform: translate3d(calc(-50% - 360px), 0, 120px) rotateY(-12deg) scale(1.12); z-index: 10; }
    .card:nth-child(2)  { transform: translate3d(calc(-50% - 320px), 0, 100px) rotateY(-12deg) scale(1.10); z-index: 9; }
    .card:nth-child(3)  { transform: translate3d(calc(-50% - 240px), 0, 80px) rotateY(-12deg) scale(1.08); z-index: 8; }
    .card:nth-child(4)  { transform: translate3d(calc(-50% - 160px), 0, 50px) rotateY(-12deg) scale(1.04); z-index: 7; }
    .card:nth-child(5)  { transform: translate3d(calc(-50% - 80px), 0, 20px) rotateY(-12deg) scale(1.02); z-index: 6; }
    .card:nth-child(6)  { transform: translate3d(calc(-50%), 0, 0px) rotateY(-12deg) scale(1); z-index: 5; }
    .card:nth-child(7)  { transform: translate3d(calc(-50% + 80px), 0, -10px) rotateY(-12deg) scale(0.98); z-index: 4; }
    .card:nth-child(8)  { transform: translate3d(calc(-50% + 160px), 0, -40px) rotateY(-12deg) scale(0.96); z-index: 3; }
    .card:nth-child(9)  { transform: translate3d(calc(-50% + 240px), 0, -60px) rotateY(-12deg) scale(0.95); z-index: 2; }
    .download-btn {
      position: fixed;
      left: 32px;
      bottom: 32px;
      font-family: 'Manofa', Arial, sans-serif;
      font-size: 0.92rem;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      background: #111;
      color: #fff;
      border: none;
      border-radius: 0;
      padding: 8px 16px;
      cursor: pointer;
      box-shadow: 0 2px 12px rgba(0,0,0,0.18);
      transition: background 0.2s, color 0.2s;
      z-index: 10000;
    }
    .download-btn:hover { background: #fff; color: #fff; }
  </style>
  <style>
    #scrollDownTag {
      position: fixed;
      bottom: 32px;
      right: 32px;
      min-width: 72px;
      min-height: 40px;
      background: transparent;
      color: #fff;
      /* border-radius removed */
      display: flex;
      align-items: center;
      justify-content: center;
      font-family: 'Manofa', Arial, sans-serif;
      font-size: 0.89rem;
      letter-spacing: 0.08em;
      box-shadow: none;
      z-index: 10010;
      user-select: none;
      text-align: center;
      line-height: 1.1;
      pointer-events: none;
      gap: 6px;
      flex-direction: row;
    }
    #scrollDownTag .arrow {
      font-size: 1.2rem;
      margin-left: 2px;
      display: flex;
      align-items: center;
    }
  </style>
</head>
  <body>
    <!-- Background Slideshow Overlay -->
    <div id="backgroundSlideshow" style="position:fixed;top:0;left:0;width:100vw;height:100vh;z-index:-2;background:url('background/location 6 cover image copy.png') center center/cover no-repeat #000;">
      <div style="position:absolute;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,0.38);"></div>
    </div>
    
    <script>
    // Background image slideshow using a fixed div
    window.addEventListener('load', function() {
      var bgImages = [
        'background/location 1 cover image copy.png',
        'background/location 2 cover image copy.png',
        'background/location 3 cover image copy.png',
        'background/location 4 cover image copy.png',
        'background/location 5 cover image copy.png',
        'background/location 6 cover image copy.png',
        'background/location 7 cover image copy.png',
        'background/location 8 cover image copy.png',
        'background/location 9 cover image copy.png',
        'background/location 10 cover image copy.png'
      ];
      var curIdx = 0;
      var bgDiv = document.getElementById('backgroundSlideshow');
      var failedCount = 0;
      // Debug overlay removed
      setBg(curIdx);
      setInterval(function() {
        curIdx = (curIdx + 1) % bgImages.length;
        setBg(curIdx);
      }, 10000);
    });
    </script>
    <!-- Overlay Card that appears after GIF ends -->
    <!-- A4 Overlay Card (after GIF ends) -->
    <div id="a4OverlayCard" class="overlay-fullscreen" style="display:none;">
      <div class="a4-overlay-inner">
        <img src="images for cards/cover page.png" alt="Cover Page" class="a4-overlay-img" />
      </div>
    </div>
    <style>
      .overlay-fullscreen {
        position: fixed;
        z-index: 29999;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        background: rgba(0,0,0,0.98);
        align-items: center;
        justify-content: center;
        transition: opacity 0.5s;
        pointer-events: auto;
        display: flex;
        opacity: 1;
      }
      .a4-overlay-inner {
        height: 90vh;
        width: calc(90vh * 0.769);
        max-width: 98vw;
        background: white;
        box-shadow: 0 12px 30px rgba(0,0,0,0.55);
        border-radius: 0;
        display: flex;
        align-items: center;
        justify-content: center;
        position: relative;
      }
      .a4-overlay-img {
        width: 100%;
        height: 100%;
        object-fit: contain;
        object-position: top;
        border-radius: 0;
        display: block;
      }
    </style>
  <!-- --- Always-visible Stamp at Top Right --- -->
  <!-- Always-visible Stamp at Top Right -->
  <div id="stampCircle" style="position:fixed;top:28px;right:28px;z-index:20002;display:none;align-items:center;justify-content:center;pointer-events:auto;">
    <a href="https://www.google.com/maps/place/Ion+Square+Gardens,+London+E2+7AB/@51.5305662,-0.0690014,591m/data=!3m2!1e3!4b1!4m6!3m5!1s0x48761cc6cbfc8a53:0x93f0a70f8cb54daa!8m2!3d51.530596!4d-0.0662474!16s%2Fg%2F11b8tcnb0r?entry=ttu&g_ep=EgoyMDI2MDEwNy4wIKXMDSoASAFQAw%3D%3D" target="_blank" rel="noopener" style="display:block;width:122px;height:122px;text-decoration:none !important;border:none !important;outline:none !important;background:none !important;">
      <img id="stampImg" src="stamp/white stamp.png" alt="Stamp" style="width:122px;height:122px;object-fit:contain;display:block;margin:auto;transition:transform 0.32s cubic-bezier(.68,-0.55,.27,1.55);" />
      <div style="text-align:center;font-family:'Manofa',Arial,sans-serif;font-size:0.82rem;color:#fff;margin-top:2px;letter-spacing:0.08em;display:block;">Click &#8593;</div>
    </a>
  </div>
  <style>
    #stampCircle a, #stampCircle a * {
      text-decoration: none !important;
      border: none !important;
      outline: none !important;
      background: none !important;
      box-shadow: none !important;
    }
  </style>
  <script>
    // Stamp hover rotate and bounce
    document.addEventListener('DOMContentLoaded', function() {
      // Only center body when overlays are visible
      var stampImg = document.getElementById('stampImg');
      if (stampImg) {
        stampImg.addEventListener('mouseenter', function() {
          stampImg.style.transform = 'rotate(20deg)';
        });
        stampImg.addEventListener('mouseleave', function() {
          stampImg.style.transform = 'rotate(0deg)';
        });
      }
    });
  </script>
  <div id="scrollDownTag"><span>SCROLL DOWN</span><span class="arrow">&#8595;</span></div>


      <div id="sidebar" style="position:fixed;left:0;top:50vh;transform:translateY(-50%);height:auto;width:120px;background:none;color:#fff;z-index:100002;display:none;flex-direction:column;align-items:flex-start;padding:24px 0 24px 0;box-shadow:2px 0 16px rgba(0,0,0,0.18);font-family:'Manofa',Arial,sans-serif;">
        <div id="cpfSubSections" style="width:100%;padding-left:12px;display:flex;flex-direction:column;gap:0;font-family:'Manofa',Arial,sans-serif;">
          <a href="#section-intro" id="introBtn" class="sidebar-btn subsection-btn" style="font-family:'Manofa',Arial,sans-serif;width:100%;padding:9px 8px 9px 24px;font-size:0.59rem;letter-spacing:0.08em;text-transform:uppercase;border:none;background:none;color:#fff;cursor:pointer;text-align:left;display:block;text-decoration:none;">Intro</a>
          <a href="#section-map" id="mapBtn" class="sidebar-btn subsection-btn" style="font-family:'Manofa',Arial,sans-serif;width:100%;padding:9px 8px 9px 24px;font-size:0.59rem;letter-spacing:0.08em;text-transform:uppercase;border:none;background:none;color:#fff;cursor:pointer;text-align:left;display:block;text-decoration:none;">MAP</a>
          <a href="#section-audio" id="audioBtn" class="sidebar-btn subsection-btn" style="font-family:'Manofa',Arial,sans-serif;width:100%;padding:9px 8px 9px 24px;font-size:0.59rem;letter-spacing:0.08em;text-transform:uppercase;border:none;background:none;color:#fff;cursor:pointer;text-align:left;display:block;text-decoration:none;">Audio</a>
          <a href="#section-process" id="processBtn" class="sidebar-btn subsection-btn" style="font-family:'Manofa',Arial,sans-serif;width:100%;padding:9px 8px 9px 24px;font-size:0.59rem;letter-spacing:0.08em;text-transform:uppercase;border:none;background:none;color:#fff;cursor:pointer;text-align:left;display:block;text-decoration:none;">COLLECTION IMAGES</a>
          <a href="#section-cards" id="cardsBtn" class="sidebar-btn subsection-btn" style="font-family:'Manofa',Arial,sans-serif;width:100%;padding:9px 8px 9px 24px;font-size:0.59rem;letter-spacing:0.08em;text-transform:uppercase;border:none;background:none;color:#fff;cursor:pointer;text-align:left;display:block;text-decoration:none;">INVESTIGATION FILES</a>
          <a href="#section-download" id="downloadBtn" class="sidebar-btn subsection-btn" style="font-family:'Manofa',Arial,sans-serif;width:100%;padding:9px 8px 9px 24px;font-size:0.59rem;letter-spacing:0.08em;text-transform:uppercase;border:none;background:none;color:#fff;cursor:pointer;text-align:left;display:block;text-decoration:none;">DOWNLOAD PDF</a>
        </div>
        <style>
          .sidebar-btn.selected {
            color: #b3b2ae !important;
          }
          .subsection-btn {
            font-size: 0.59rem;
            color: #fff;
            background: none;
            border: none;
            border-bottom: 1px solid rgba(255,255,255,0.10);
            text-align: left;
            padding-left: 24px !important;
          }
          .subsection-btn.selected {
            color: #b3b2ae !important;
          }
        </style>
      </div>

  <!-- Play Audio button and annotation moved into Audio section below -->
    <div id="gifOverlay" style="position:fixed;z-index:30000;top:0;left:0;width:100vw;height:100vh;background:#000;display:flex;align-items:center;justify-content:center;opacity:1;transition:opacity 1s;">
      <img id="openingGif" src="background/location 1 cover image copy.png" alt="Opening Animation" style="max-width:100vw;max-height:100vh;display:block;">
    </div>
    <!-- No overlayCard or debug overlay present. Only gifOverlay is visible at start. -->
    <div style="position:fixed;top:24px;left:50%;transform:translateX(-50%);z-index:200001;pointer-events:none;width:auto;">
      <div id="mainTitle" style="background:#111;padding:8px 32px 8px 32px;border-radius:0;box-shadow:0 4px 32px rgba(0,0,0,0.32);font-family:'Manofa',Arial,sans-serif;font-size:2.6rem;letter-spacing:0.04em;color:#fff;text-transform:uppercase;user-select:none;pointer-events:auto;transition:opacity 0.4s;white-space:nowrap;text-align:center;opacity:0;">UNHEARD AND UNSEEN</div>
    </div>
    <script>
    // --- Overlay Card and Main Title Logic ---
    document.addEventListener('DOMContentLoaded', function() {
      var gifOverlay = document.getElementById('gifOverlay');
      var openingGif = document.getElementById('openingGif');
      var a4OverlayCard = document.getElementById('a4OverlayCard');
      var stampCircle = document.getElementById('stampCircle');
      var mainTitle = document.getElementById('mainTitle');
      // Hide overlays and mainTitle at start
      if (gifOverlay) { gifOverlay.style.display = 'flex'; gifOverlay.style.opacity = '1'; }
      if (a4OverlayCard) { a4OverlayCard.style.display = 'none'; a4OverlayCard.style.opacity = '0'; }
      if (mainTitle) { mainTitle.style.opacity = '0'; }
      // Frame-by-frame animation for openingGif
      var frames = [
        'background/location 1 cover image copy.png',
        'background/location 4 cover image copy.png',
        'background/location 6 cover image copy.png',
        'background/location 8 cover image copy.png',
        'background/location 10 cover image copy.png'
      ];
      var frameIdx = 0;
      if (openingGif) {
        openingGif.src = frames[0];
        var totalLoops = 2;
        var currentLoop = 0;
        var interval = setInterval(function() {
          frameIdx++;
          if (frameIdx < frames.length) {
            openingGif.src = frames[frameIdx];
          } else {
            currentLoop++;
            if (currentLoop < totalLoops) {
              frameIdx = 0;
              openingGif.src = frames[frameIdx];
            } else {
              clearInterval(interval);
              // Show overlay card, then fade out gifOverlay
              if (a4OverlayCard && !a4OverlayCard.getAttribute('data-closed')) {
                a4OverlayCard.style.display = 'flex';
                a4OverlayCard.style.opacity = '1';
              }
              if (gifOverlay) {
                gifOverlay.style.opacity = '0';
                setTimeout(function() {
                  gifOverlay.style.display = 'none';
                  // Show mainTitle and stamp only if both overlays are closed
                  setTimeout(function() {
                    if (
                      gifOverlay && gifOverlay.style.display === 'none' &&
                      a4OverlayCard && (a4OverlayCard.style.display === 'none' || a4OverlayCard.getAttribute('data-closed'))
                    ) {
                      if (mainTitle) mainTitle.style.opacity = '1';
                      if (stampCircle) stampCircle.style.display = 'flex';
                    }
                  }, 10);
                }, 1000);
              }
            }
          }
        }, 200);
      } else {
        if (a4OverlayCard) {
          a4OverlayCard.style.display = 'flex';
          a4OverlayCard.style.opacity = '1';
        }
        if (mainTitle) mainTitle.style.opacity = '1';
        if (stampCircle) stampCircle.style.display = 'flex';
      }
      if (a4OverlayCard) {
        a4OverlayCard.addEventListener('click', function() {
          a4OverlayCard.style.opacity = '0';
          setTimeout(function() {
            a4OverlayCard.style.display = 'none';
            a4OverlayCard.setAttribute('data-closed', 'true');
            // Show mainTitle and stamp after overlay closes
            if (mainTitle) mainTitle.style.opacity = '1';
            if (stampCircle) stampCircle.style.display = 'flex';
          }, 400);
        });
      }
    });

    // --- Sidebar Highlight on Scroll ---
    document.addEventListener('DOMContentLoaded', function() {
      const cpfBtn = document.getElementById('cpfBtn');
      const microscopicBtn = document.getElementById('microscopicBtn');
      const processBtn = document.getElementById('processBtn');
      const audioBtn = document.getElementById('audioBtn');
      const mapBtn = document.getElementById('mapBtn');
      const downloadBtn = document.getElementById('downloadBtn');
      const sectionCards = document.getElementById('section-cards');
      const sectionMicroscopic = document.getElementById('section-microscopic');
      const sectionProcess = document.getElementById('section-process');
      const sectionAudio = document.getElementById('section-audio');
      const sectionMap = document.getElementById('section-map');
      const sectionDownload = document.getElementById('section-download');
      function highlightSidebar() {
        const cardsRect = sectionCards.getBoundingClientRect();
        const microRect = sectionMicroscopic.getBoundingClientRect();
        const processRect = sectionProcess.getBoundingClientRect();
        const audioRect = sectionAudio.getBoundingClientRect();
        const mapRect = sectionMap.getBoundingClientRect();
        const downloadRect = sectionDownload.getBoundingClientRect();
        const viewportCenter = window.innerHeight / 2;
        const distCards = Math.abs((cardsRect.top + cardsRect.height/2) - viewportCenter);
        const distMicro = Math.abs((microRect.top + microRect.height/2) - viewportCenter);
        const distProcess = Math.abs((processRect.top + processRect.height/2) - viewportCenter);
        const distAudio = Math.abs((audioRect.top + audioRect.height/2) - viewportCenter);
        const distMap = Math.abs((mapRect.top + mapRect.height/2) - viewportCenter);
        const distDownload = Math.abs((downloadRect.top + downloadRect.height/2) - viewportCenter);
        const minDist = Math.min(distCards, distMicro, distProcess, distAudio, distMap, distDownload);
        cpfBtn.classList.remove('selected');
        microscopicBtn.classList.remove('selected');
        processBtn.classList.remove('selected');
        audioBtn.classList.remove('selected');
        mapBtn.classList.remove('selected');
        downloadBtn.classList.remove('selected');
        if (minDist === distCards) {
          cpfBtn.classList.add('selected');
        } else if (minDist === distMicro) {
          microscopicBtn.classList.add('selected');
        } else if (minDist === distProcess) {
          processBtn.classList.add('selected');
        } else if (minDist === distMap) {
          mapBtn.classList.add('selected');
        } else if (minDist === distDownload) {
          downloadBtn.classList.add('selected');
        } else {
          audioBtn.classList.add('selected');
        }
      }
      window.addEventListener('scroll', highlightSidebar);
      highlightSidebar();
    });


      // Show GIF overlay for 4 seconds, then fade out over 1 second, then remove
      // Start background audio after GIF overlay is removed
      window.addEventListener('DOMContentLoaded', function() {
        // --- Audio Time Display Logic ---
        var audio = document.getElementById('bgAudio');
        var audioTimeDisplay = document.getElementById('audioTimeDisplay');
        function formatTime(seconds) {
          seconds = Math.floor(seconds);
          var min = Math.floor(seconds / 60);
          var sec = seconds % 60;
          return min + ':' + (sec < 10 ? '0' : '') + sec;
        }
        function updateAudioTimeDisplay() {
          if (!audio || !audioTimeDisplay) return;
          var cur = isNaN(audio.currentTime) ? 0 : audio.currentTime;
          var dur = isNaN(audio.duration) ? 0 : audio.duration;
          audioTimeDisplay.textContent = formatTime(cur) + ' / ' + formatTime(dur);
        }
        if (audio) {
          audio.addEventListener('timeupdate', updateAudioTimeDisplay);
          audio.addEventListener('durationchange', updateAudioTimeDisplay);
          audio.addEventListener('loadedmetadata', updateAudioTimeDisplay);
          audio.addEventListener('play', updateAudioTimeDisplay);
          audio.addEventListener('pause', updateAudioTimeDisplay);
          updateAudioTimeDisplay();
        }
        var overlay = document.getElementById('gifOverlay');
        var audio = document.getElementById('bgAudio');
        var audioBtn = document.getElementById('audioPlayBtn');
        var stampCircle = document.getElementById('stampCircle');
        var a4OverlayCard = document.getElementById('a4OverlayCard');
        // ...audio slider removed...
        setTimeout(function() {
              if (a4OverlayCard && !a4OverlayCard.getAttribute('data-closed')) {
                a4OverlayCard.style.display = 'flex';
                a4OverlayCard.style.opacity = '1';
              }
          if (overlay) {
            overlay.style.opacity = '0';
            setTimeout(function() {
              if (overlay && overlay.parentNode) overlay.parentNode.removeChild(overlay);
              // Show sidebar after GIF overlay disappears
              var sidebar = document.getElementById('sidebar');
              if (sidebar) sidebar.style.display = 'flex';
              if (audioBtn) {
                audioBtn.style.display = 'block';
                // audioTextLine will be shown only when audio is played
              }
              // Show stamp after intro GIF disappears
              if (stampCircle) stampCircle.style.display = 'flex';
            }, 1000); // 1s fade out
          }
        }, 4000); // Start fade at 4s

        if (audioBtn && audio) {
          let isPlaying = false;
          const textLine = document.getElementById('audioTextLine');
          // Texts to show at each 20s interval
          const textOptions = [
            'Location 01, Grass, 51.53036, -0.06603',
            'Location 02, Metal Park Bench, 51.53035, -0.06604',
            'Location 03, Tarmac, 51.53012, -0.06572',
            'Location 04, Slide, 51.53005, -0.06587',
            'Location 05, Bush, 51.53070, -0.06584',
            'Location 06, Tree, 51.53072, -0.06593',
            'Location 07, Tree Trunk Circle, 51.53026, -0.06688',
            'Location 08, Desire Path, 51.53050, -0.06685',
            'Location 09, Exit (left), 51.53077, -0.06679',
            'Location 10, Exit (right), 51.53076, -0.06678'
          ];
          let textInterval = null;
          let lastTextIdx = 0;

          function updateText(force) {
            if (!audio || !textLine || isNaN(audio.duration) || audio.duration === 0) return;
            if (window.isScrubbing) return; // Don't update while scrubbing
            let idx = Math.floor(audio.currentTime / (audio.duration / textOptions.length));
            if (idx < 0) idx = 0;
            if (idx >= textOptions.length) idx = textOptions.length - 1;
            textLine.textContent = textOptions[idx];
            lastTextIdx = idx;
          }

          function startTextInterval() {
            if (textInterval) return;
            updateText(true);
            textInterval = setInterval(updateText, 500);
          }
          function stopTextInterval() {
            if (textInterval) {
              clearInterval(textInterval);
              textInterval = null;
            }
          }
          // Also update text when user scrubs
          var scrubBar = document.getElementById('audioScrubBar');
          if (scrubBar) {
                        // Keep scrub bar in sync with audio position
                        audio.addEventListener('timeupdate', function() {
                          if (!window.isScrubbing && !isNaN(audio.duration)) {
                            scrubBar.value = (audio.currentTime / audio.duration) * 100;
                          }
                        });
            window.isScrubbing = false;
            function setTextForScrubValue() {
              if (!audio || !textLine || isNaN(audio.duration) || audio.duration === 0) return;
              var scrubTime = (scrubBar.value / 100) * audio.duration;
              let idx = Math.floor(scrubTime / (audio.duration / textOptions.length));
              if (idx < 0) idx = 0;
              if (idx >= textOptions.length) idx = textOptions.length - 1;
              textLine.textContent = textOptions[idx];
              lastTextIdx = idx;
            }
            scrubBar.addEventListener('mousedown', function() { window.isScrubbing = true; stopTextInterval(); });
            scrubBar.addEventListener('touchstart', function() { window.isScrubbing = true; stopTextInterval(); });
            scrubBar.addEventListener('input', setTextForScrubValue);
            function handleScrubEnd() {
              window.isScrubbing = false;
              // Set audio time to match scrub bar
              if (audio && !isNaN(audio.duration)) {
                audio.currentTime = (scrubBar.value / 100) * audio.duration;
              }
              setTextForScrubValue();
              if (isPlaying) startTextInterval();
              // Also update scrub bar thumb position after scrubbing
              if (audio && !isNaN(audio.duration)) {
                scrubBar.value = (audio.currentTime / audio.duration) * 100;
              }
            }
            scrubBar.addEventListener('mouseup', handleScrubEnd);
            scrubBar.addEventListener('touchend', handleScrubEnd);
          }

          audioBtn.addEventListener('click', function() {
            audio.volume = 1.0;
            if (!isPlaying) {
              audio.play().catch(function(){});
              audioBtn.textContent = 'Pause Audio';
              isPlaying = true;
              textLine.style.display = 'block';
              startTextInterval();
            } else {
              audio.pause();
              audioBtn.textContent = 'Play Audio';
              isPlaying = false;
              textLine.style.display = 'none';
              stopTextInterval();
            }
          });
          // Update button text and text line if audio is paused by other means
          audio.addEventListener('pause', function() {
            audioBtn.textContent = 'Play Audio';
            isPlaying = false;
            textLine.style.display = 'none';
            stopTextInterval();
          });
          audio.addEventListener('play', function() {
            audioBtn.textContent = 'Pause Audio';
            isPlaying = true;
            textLine.style.display = 'block';
            startTextInterval();
          });
        }
      });
    </script>
  <!-- ...existing code... (all other content and scripts remain inside <body>) ... -->
  <!-- Card Stack Section will be moved below collection images and above download PDF -->

  <!-- Intro Section (above MAP) -->
  <section id="section-intro" style="min-height:100vh;width:100vw;display:flex;align-items:center;justify-content:center;scroll-snap-align:start;">
    <div style="display:flex;flex-direction:column;align-items:center;justify-content:center;max-width:700px;width:90vw;margin-top:-40px;">
      <h2 style="color:#fff;font-family:'Manofa',Arial,sans-serif;font-size:2.1rem;margin-bottom:18px;text-align:center;letter-spacing:0.04em;">A Sonic Exploration of Transitional Space</h2>
      <div style="color:#fff;font-family:'Manofa',Arial,sans-serif;font-size:1.08rem;line-height:1.5;text-align:center;margin-bottom:18px;letter-spacing:0.03em;">
        An interactive experience revealing the often unheard and unseen qualities of space. Investigation files are listed at the end for further reading. Focus location: Ion Square Gardens, Bethnal Green, E2 7AB
      </div>
    </div>
  </section>

  <!-- MAP Section (moved to top) -->
  <section id="section-map" class="main-section" style="min-height:100vh;width:100vw;display:flex;flex-direction:column;align-items:center;justify-content:center;scroll-snap-align:start;">
    <div class="main-section" style="position:relative;display:flex;flex-direction:column;align-items:center;">
      <h2 style="color:#fff;font-family:'Manofa',Arial,sans-serif;font-size:2rem;margin-bottom:10px;text-align:center;width:100%;max-width:1200px;margin-left:auto;margin-right:auto;">MAP</h2>
      <div style="color:#fff;font-family:'Manofa',Arial,sans-serif;font-size:1.1rem;margin-bottom:24px;text-align:center;width:100%;max-width:700px;margin-left:auto;margin-right:auto;letter-spacing:0.06em;">Map of Ion Square Gardens, the selected transitional space. Please click below to open the interactive map.</div>
        <button id="openMapModalBtn" class="map-modal-btn" style="width:120px;height:auto;">
          <img src="map button/map button.jpg" alt="Open Interactive Map" class="map-modal-img" style="width:120px;height:auto;" />
        </button>
    </div>
  </section>

  <!-- Map Modal Overlay -->
  <div id="mapModal" class="overlay-fullscreen" style="display:none;z-index:30020;flex-direction:column;align-items:center;justify-content:center;overflow:auto;">
    <div id="mapModalTitle" style="position:absolute;top:18px;left:50%;transform:translateX(-50%);font-family:'Manofa',Arial,sans-serif;font-size:2.1rem;letter-spacing:0.04em;color:#fff;text-transform:uppercase;z-index:20;text-align:center;pointer-events:none;user-select:none;">MAP</div>
    <button id="closeMapModal" type="button" style="position:absolute;top:32px;right:48px;font-size:2.2rem;background:none;border:none;color:#fff;cursor:pointer;z-index:21;">&times;</button>
    <div id="mapInstructionCircle" style="position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);background:transparent;border-radius:50%;width:95.625px;height:95.625px;display:flex;align-items:center;justify-content:center;text-align:center;box-shadow:0 4px 32px 0 rgba(0,0,0,0.25);z-index:20;pointer-events:none;user-select:none;">
      <div style="position:absolute;width:100%;height:100%;left:0;top:0;z-index:1;background:rgba(179,178,174,0.5);border-radius:50%;"></div>
      <div style="position:absolute;width:100%;height:100%;left:0;top:0;z-index:2;display:flex;align-items:center;justify-content:center;">
        <span style="color:black;font-size:0.68rem;font-weight:bold;text-shadow:0 2px 8px rgba(0,0,0,0.12);padding:6px;">Click location markers to uncover the unseen and unheard</span>
      </div>
    </div>
<script>
// --- Bouncing Instructional Circle Animation ---
document.addEventListener('DOMContentLoaded', function() {
  const mapModal = document.getElementById('mapModal');
  const instructionCircle = document.getElementById('mapInstructionCircle');
  const mapImg = document.getElementById('mapImage');
  let animFrame, pos = {x: 0, y: 0}, vel = {x: 2, y: 2}, circleSize = 128, started = false;

  function randomVelocity() {
    // Random direction, speed between 1 and 1.75 px per frame (slower)
    let angle = Math.random() * 2 * Math.PI;
    let speed = 1 + Math.random() * 0.75;
    return {x: Math.cos(angle) * speed, y: Math.sin(angle) * speed};
  }

  function startBounce() {
    if (!mapModal || !instructionCircle || !mapImg) return;
    // Get map image bounds relative to modal
    const mapRect = mapImg.getBoundingClientRect();
    const modalRect = mapModal.getBoundingClientRect();
    // Animation bounds (relative to modal)
    const bounds = {
      left: mapRect.left - modalRect.left,
      top: mapRect.top - modalRect.top,
      right: mapRect.right - modalRect.left,
      bottom: mapRect.bottom - modalRect.top
    };
    // Start at random position inside map
    pos.x = bounds.left + Math.random() * (bounds.right - bounds.left - circleSize);
    pos.y = bounds.top + Math.random() * (bounds.bottom - bounds.top - circleSize);
    vel = randomVelocity();
    instructionCircle.style.left = pos.x + 'px';
    instructionCircle.style.top = pos.y + 'px';
    instructionCircle.style.transform = 'translate(0,0)';
    instructionCircle.style.transition = 'none';
    started = true;
    function animate() {
      pos.x += vel.x;
      pos.y += vel.y;
      // Bounce off edges
      let bounced = false;
      if (pos.x <= bounds.left) {
        pos.x = bounds.left;
        vel = randomVelocity();
        if (vel.x < 0) vel.x *= -1;
        bounced = true;
      } else if (pos.x + circleSize >= bounds.right) {
        pos.x = bounds.right - circleSize;
        vel = randomVelocity();
        if (vel.x > 0) vel.x *= -1;
        bounced = true;
      }
      if (pos.y <= bounds.top) {
        pos.y = bounds.top;
        vel = randomVelocity();
        if (vel.y < 0) vel.y *= -1;
        bounced = true;
      } else if (pos.y + circleSize >= bounds.bottom) {
        pos.y = bounds.bottom - circleSize;
        vel = randomVelocity();
        if (vel.y > 0) vel.y *= -1;
        bounced = true;
      }
      instructionCircle.style.left = pos.x + 'px';
      instructionCircle.style.top = pos.y + 'px';
      if (bounced) {
        // Prevent sticking to edge
        pos.x += vel.x;
        pos.y += vel.y;
      }
      animFrame = requestAnimationFrame(animate);
    }
    animFrame = requestAnimationFrame(animate);
  }
  function stopBounce() {
    if (animFrame) cancelAnimationFrame(animFrame);
    started = false;
    // Reset to center
    instructionCircle.style.left = '50%';
    instructionCircle.style.top = '50%';
    instructionCircle.style.transform = 'translate(-50%,-50%)';
    instructionCircle.style.transition = '';
  }
  if (mapModal && instructionCircle && mapImg) {
    // Start animation when modal opens
    const observer = new MutationObserver(function() {
      if (mapModal.style.display === 'flex' && !started) {
        setTimeout(startBounce, 250); // Wait for layout
      } else if (mapModal.style.display === 'none' && started) {
        stopBounce();
      }
    });
    observer.observe(mapModal, { attributes: true, attributeFilter: ['style'] });
  }
});
</script>
    <div style="display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:100vh;width:100vw;background:rgba(0,0,0,0.65);z-index:5;">
      <div style="width:100%;max-width:1200px;margin-left:auto;margin-right:auto;position:relative;">
        <div style="position:absolute;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.55);border-radius:18px;z-index:0;"></div>
        <div style="position:relative;z-index:1;">
          <div style="display:flex;flex-direction:row;align-items:center;width:100%;max-width:1200px;margin-left:auto;margin-right:auto;position:relative;">
            <div id="mapKey" style="position:absolute;left:110px;top:50%;bottom:auto;transform:translateY(-50%);display:none;flex-direction:column;align-items:center;z-index:20;background:rgba(0,0,0,0.85);padding:13.5px 18px 13.5px 18px;border-radius:0;box-shadow:0 4px 24px rgba(0,0,0,0.22);gap:13.5px;">
              <div style="font-family:'Manofa',Arial,sans-serif;font-size:0.9rem;color:#fff;letter-spacing:0.06em;margin-bottom:6px;text-align:center;">[KEY]</div>
              <div id="mapKeyCol" style="display:flex;flex-direction:column;gap:13.5px;align-items:center;"></div>
            </div>
            <div style="width:100%;display:flex;justify-content:center;align-items:center;position:relative;">
                <img src="map/key for map.png" alt="Map Key" style="position:absolute;left:180px;bottom:20px;width:120px;height:auto;z-index:30;background:rgba(0,0,0,0.12);border-radius:0;" />
              <img id="mapImage" src="map/map.jpg" alt="Map" style="max-width:896.484375px;width:89.6484375vw;height:auto;box-shadow:0 4px 32px rgba(0,0,0,0.32);border-radius:0;position:relative;z-index:1;" />
              <svg id="mapLineSVG" style="position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:2;" xmlns="http://www.w3.org/2000/svg">
                <g style="display:none;">
                  <line id="circleLine1" x1="66%" y1="50%" x2="62%" y2="65%" stroke="#b3b2ae" stroke-width="2" stroke-linecap="round" />
                  <line id="circleLine2" x1="62%" y1="65%" x2="75%" y2="91%" stroke="#b3b2ae" stroke-width="2" stroke-linecap="round" />
                  <line id="circleLine3" x1="75%" y1="91%" x2="68%" y2="91%" stroke="#b3b2ae" stroke-width="2" stroke-linecap="round" />
                  <line id="circleLine4" x1="68%" y1="91%" x2="70%" y2="20%" stroke="#b3b2ae" stroke-width="2" stroke-linecap="round" />
                  <line id="circleLine5" x1="70%" y1="20%" x2="63%" y2="25%" stroke="#b3b2ae" stroke-width="2" stroke-linecap="round" />
                  <line id="circleLine6" x1="63%" y1="25%" x2="28%" y2="52%" stroke="#b3b2ae" stroke-width="2" stroke-linecap="round" />
                  <line id="circleLine7" x1="28%" y1="52%" x2="30%" y2="35%" stroke="#b3b2ae" stroke-width="2" stroke-linecap="round" />
                  <line id="circleLine8" x1="30%" y1="35%" x2="30%" y2="9%" stroke="#b3b2ae" stroke-width="2" stroke-linecap="round" />
                  <line id="circleLine9" x1="30%" y1="9%" x2="24%" y2="20%" stroke="#b3b2ae" stroke-width="2" stroke-linecap="round" />
                </g>
              </svg>
              <div id="mapMicroscopicMarkers" style="position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:10;"></div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
        <script>
        // --- Add interactive microscopic markers to map and key ---
        document.addEventListener('DOMContentLoaded', function() {
          var mapImage = document.getElementById('mapImage');
          var markersOverlay = document.getElementById('mapMicroscopicMarkers');
          var mapKey = document.getElementById('mapKey');
            var markerPositions = [
              {left:66, top:50}, // circle 1
              {left:62, top:65}, // circle 2, moved further down and right to avoid overlap
            {left:80, top:91}, // circle 3 moved right
            {left:73, top:91}, // circle 4 moved right
            {left:75, top:20}, // circle 5 moved right
            {left:68, top:25}, // circle 6 moved right
            {left:24, top:56}, // circle 7 moved left
            {left:26, top:39}, // circle 8 moved left
            {left:30, top:9}, // circle 9, moved down slightly
            {left:24, top:20} // circle 10, moved left very slightly
          ];
          var markerStills = [
            'microscopic gifs/location 1 cover image.png',
            'microscopic gifs/location 2 cover image.png',
            'microscopic gifs/location 3 cover image.png',
            'microscopic gifs/location 4 cover image.png',
            'microscopic gifs/location 5 cover image.png',
            'microscopic gifs/location 6 cover image.png',
            'microscopic gifs/location 7 cover image.png',
            'microscopic gifs/location 8 cover image.png',
            'microscopic gifs/location 9 cover image.png',
            'microscopic gifs/location 10 cover image.png'
          ];
          function createMarker(idx, left, top) {
            var marker = document.createElement('div');
            // Create a wrapper for annotation and marker
            var wrapper = document.createElement('div');
            wrapper.style.position = 'absolute';
            wrapper.style.left = left + '%';
            wrapper.style.top = top + '%';
            wrapper.style.transform = 'translate(-50%,-50%)';
            wrapper.style.pointerEvents = 'none';
            wrapper.style.zIndex = '21';
            // Annotation above marker
            var annotation = document.createElement('div');
            annotation.textContent = [
              'Grass',
              'Metal Park Bench',
              'Tarmac',
              'Slide',
              'Hedge',
              'Tree',
              'Tree Trunk Circle',
              'Desire Path',
              'Exit (left)',
              'Exit (right)'
            ][idx];
            annotation.style.position = 'absolute';
            annotation.style.left = '50%';
            annotation.style.top = '-22px';
            annotation.style.transform = 'translateX(-50%)';
            annotation.style.fontFamily = "'Manofa', Arial, sans-serif";
            annotation.style.fontSize = '0.72rem';
            annotation.style.color = '#111';
            annotation.style.letterSpacing = '0.06em';
            annotation.style.textShadow = 'none';
            annotation.style.pointerEvents = 'none';
            annotation.style.userSelect = 'none';
            annotation.style.whiteSpace = 'nowrap';
            annotation.style.background = 'none';
            annotation.style.padding = '0';
            annotation.style.borderRadius = '0';
            wrapper.appendChild(annotation);
            // Marker itself
            marker.className = 'map-micro-marker';
            marker.setAttribute('data-index', idx);
            marker.style.width = '71.25px';
            marker.style.height = '71.25px';
            marker.style.border = 'none';
            marker.style.borderRadius = '50%';
            marker.style.transform = 'none';
            marker.style.cursor = 'pointer';
            marker.style.display = 'flex';
            marker.style.alignItems = 'center';
            marker.style.justifyContent = 'center';
            marker.style.boxShadow = '0 2px 8px rgba(0,0,0,0.18)';
            marker.style.zIndex = '20';
            marker.style.pointerEvents = 'auto';
            marker.style.transition = 'none';
            marker.style.background = '#ccc'; // For testing, replace with image if not laggy
            marker.style.willChange = 'transform, box-shadow';
            marker.style.overflow = 'hidden';
            // Add a zoom-in effect by using a pseudo-element for the image
            var zoomImg = document.createElement('div');
            zoomImg.style.width = '100%';
            zoomImg.style.height = '100%';
            zoomImg.style.background = 'url("' + markerStills[idx] + '") center center/cover no-repeat';
            zoomImg.style.transform = 'scale(1.5)';
            zoomImg.style.borderRadius = '50%';
            zoomImg.style.pointerEvents = 'none';
            marker.appendChild(zoomImg);
            // Add event listeners to marker
            marker.addEventListener('mouseenter', function() {
              marker.style.transition = 'none';
              marker.style.boxShadow = '0 12px 48px #b3b2ae, 0 2px 8px rgba(0,0,0,0.22)';
              marker.style.transform = 'scale(1.32)';
            });
            marker.addEventListener('mouseleave', function() {
              marker.style.transition = 'none';
              marker.style.boxShadow = '0 2px 8px rgba(0,0,0,0.18)';
              marker.style.transform = 'scale(1)';
            });
            marker.addEventListener('click', function(e) {
              e.stopPropagation();
              var grid = document.getElementById('microscopicGrid');
              var modal = document.getElementById('microscopicModal');
              if (typeof showModal === 'function') {
                showModal(idx);
              } else {
                var card = document.querySelector('.micro-card[data-index="'+idx+'"]');
                if (card) card.click();
              }
            });
            wrapper.appendChild(marker);
            return wrapper;
          }
          function renderMarkers() {
            if (!markersOverlay) return;
            markersOverlay.innerHTML = '';
            markerPositions.forEach(function(pos, idx) {
              var marker = createMarker(idx, pos.left, pos.top);
              markersOverlay.appendChild(marker);
            });
          }
          function createKeyCircle(idx) {
            var wrapper = document.createElement('div');
            wrapper.style.position = 'relative';
            wrapper.style.width = '26.7px';
            wrapper.style.height = '26.7px';
            // Circle
            var keyCircle = document.createElement('div');
            keyCircle.className = 'map-key-circle';
            keyCircle.setAttribute('data-index', idx);
            keyCircle.style.width = '26.7px';
            keyCircle.style.height = '26.7px';
            keyCircle.style.borderRadius = '50%';
            keyCircle.style.background = '#fff';
            keyCircle.style.boxShadow = '0 1.5px 6px rgba(0,0,0,0.18)';
            keyCircle.style.cursor = 'pointer';
            keyCircle.style.transition = 'box-shadow 0.2s, transform 0.2s';
            keyCircle.style.display = 'flex';
            keyCircle.style.alignItems = 'center';
            keyCircle.style.justifyContent = 'center';
            keyCircle.style.zIndex = '100';
            // Number label (overlay)
            var numLabel = document.createElement('div');
            numLabel.textContent = (idx+1).toString().padStart(2, '0');
            numLabel.style.fontFamily = 'Manofa, Arial, sans-serif';
            numLabel.style.fontSize = '0.61rem';
            numLabel.style.color = '#111';
            numLabel.style.letterSpacing = '0.06em';
            numLabel.style.position = 'absolute';
            numLabel.style.top = '50%';
            numLabel.style.left = '50%';
            numLabel.style.transform = 'translate(-50%,-50%)';
            numLabel.style.textAlign = 'center';
            numLabel.style.userSelect = 'none';
            numLabel.style.pointerEvents = 'none';
            wrapper.appendChild(keyCircle);
            wrapper.appendChild(numLabel);
            keyCircle.addEventListener('mouseenter', function() {
              var marker = document.querySelector('.map-micro-marker[data-index="'+idx+'"]');
              if (marker) {
                marker.style.boxShadow = '0 4px 24px #b3b2ae';
                marker.style.transform = 'scale(1.09)';
              }
              keyCircle.style.boxShadow = '0 4px 24px #b3b2ae';
              keyCircle.style.transform = 'scale(1.15)';
            });
            keyCircle.addEventListener('mouseleave', function() {
              var marker = document.querySelector('.map-micro-marker[data-index="'+idx+'"]');
              if (marker) {
                marker.style.boxShadow = '0 2px 8px rgba(0,0,0,0.18)';
                marker.style.transform = 'none';
              }
              keyCircle.style.boxShadow = '0 2px 8px rgba(0,0,0,0.18)';
              keyCircle.style.transform = 'scale(1)';
            });
            return wrapper;
          }
          function renderKey() {
            var col = document.getElementById('mapKeyCol');
            if (!col) return;
            col.innerHTML = '';
            markerStills.forEach(function(_, idx) {
              var keyCircle = createKeyCircle(idx);
              col.appendChild(keyCircle);
            });
          }
          if (mapImage) {
            mapImage.addEventListener('load', function() {
              renderMarkers();
              renderKey();
            });
            window.addEventListener('resize', renderMarkers);
            renderMarkers();
            renderKey();
          }
        });
        </script>
    <!-- Map Modal Overlay -->
    <!-- Map Modal Overlay and enlarge feature removed -->
    </div>
  </section>

  <!-- Audio Section (moved below MAP) -->
  <section id="section-audio" style="min-height:100vh;width:100vw;display:flex;flex-direction:column;align-items:center;justify-content:center;scroll-snap-align:start;">
    <div class="audio-bg-card" style="position:relative;width:min(700px,90vw);max-width:100%;min-height:400px;border-radius:0;box-shadow:0 8px 32px rgba(0,0,0,0.32);display:flex;flex-direction:column;align-items:center;justify-content:center;margin:0 auto 0 auto;overflow:visible;">
      <!-- To add your own image, set as background-image on this div or add an <img> below with absolute positioning -->
      <h2 style="color:#fff;font-family:'Manofa',Arial,sans-serif;font-size:2rem;margin-bottom:10px;text-align:center;width:100%;z-index:1;">Audio</h2>
      <div style="color:#fff;font-family:'Manofa',Arial,sans-serif;font-size:1.1rem;margin-bottom:24px;text-align:center;width:100%;letter-spacing:0.06em;z-index:1;">Click below to listen to the collected sound</div>
      <div style="display:flex;flex-direction:column;align-items:center;justify-content:center;width:100%;z-index:1;">
        <div id="audioTextLine" style="display:none;position:static;margin-bottom:18px;font-family:'Manofa',Arial,sans-serif;font-size:0.79rem;letter-spacing:0.08em;color:#fff;background:rgba(0,0,0,0.7);padding:7px 18px 7px 12px;border-radius:0;max-width:540px;text-align:right;transition:opacity 0.3s;white-space:nowrap;"></div>
        <button id="audioPlayBtn" style="display:block;position:static;margin:0 auto;z-index:30001;font-family:'Manofa',Arial,sans-serif;font-size:1.84rem;letter-spacing:0.08em;text-transform:uppercase;background:#111;color:#fff;border:none;border-radius:0;padding:16px 32px;cursor:pointer;transition:background 0.2s,color 0.2s;">Play Audio</button>
        <div id="audioTimeDisplay" style="color:#fff;font-family:'Manofa',Arial,sans-serif;font-size:1rem;margin:10px 0 0 0;text-align:center;letter-spacing:0.06em;">0:00 / 0:00</div>
        <input type="range" id="audioScrubBar" min="0" max="100" value="0" step="0.01" style="width:90%;margin:18px auto 0 auto;display:block;accent-color:#b3b2ae;height:4px;">
        <audio id="bgAudio" src="background audio/audio only.wav?v=20260102" loop></audio>
      </div>
    </div>
  </section>

  <!-- Microscopic Imagery Section -->
  <section id="section-microscopic" style="min-height:100vh;width:100vw;display:flex;flex-direction:column;align-items:center;justify-content:center;scroll-snap-align:start;">
    <h2 style="color:#fff;font-family:'Manofa',Arial,sans-serif;font-size:2rem;margin-bottom:10px;text-align:center;width:100%;max-width:1200px;margin-left:auto;margin-right:auto;">Microscopic Imagery Thumbnails</h2>
    <div style="color:#fff;font-family:'Manofa',Arial,sans-serif;font-size:1.1rem;margin-bottom:24px;text-align:center;width:100%;max-width:1200px;margin-left:auto;margin-right:auto;letter-spacing:0.06em;">Expand each image to view audio reactive animations</div>
    <div id="microscopicGrid" style="display:grid;grid-template-columns:repeat(5, 1fr);grid-template-rows:repeat(2, 1fr);gap:8px;justify-items:center;align-items:center;width:100%;max-width:1200px;z-index:100000;padding-left:122.5px;padding-right:122.5px;margin:8px auto 0 auto;">
      <div style="display:flex;flex-direction:column;align-items:center;margin-bottom:18px;">
        <div class="micro-card" data-index="0" style="width:180px;height:120px;background:white;border-radius:0;box-shadow:0 4px 24px rgba(0,0,0,0.18);display:flex;align-items:center;justify-content:center;cursor:pointer;">
          <img src="microscopic gifs/location 1 cover image.png" alt="Location 01" style="width:100%;height:100%;object-fit:cover;border-radius:0;">
        </div>
        <div style="margin-top:6px;color:#fff;font-family:'Manofa',Arial,sans-serif;font-size:0.61rem;letter-spacing:0.06em;text-align:center;width:180px;line-height:1.18;">Location 01, Grass<br>51.53036, -0.06603</div>
      </div>
      <div style="display:flex;flex-direction:column;align-items:center;margin-bottom:18px;">
        <div class="micro-card" data-index="1" style="width:180px;height:120px;background:white;border-radius:0;box-shadow:0 4px 24px rgba(0,0,0,0.18);display:flex;align-items:center;justify-content:center;cursor:pointer;">
          <img src="microscopic gifs/location 2 cover image.png" alt="Location 02" style="width:100%;height:100%;object-fit:cover;border-radius:0;">
        </div>
        <div style="margin-top:6px;color:#fff;font-family:'Manofa',Arial,sans-serif;font-size:0.61rem;letter-spacing:0.06em;text-align:center;width:180px;line-height:1.18;">Location 02, Metal Park Bench<br>51.53035, -0.06604</div>
      </div>
      <div style="display:flex;flex-direction:column;align-items:center;margin-bottom:18px;">
        <div class="micro-card" data-index="2" style="width:180px;height:120px;background:white;border-radius:0;box-shadow:0 4px 24px rgba(0,0,0,0.18);display:flex;align-items:center;justify-content:center;cursor:pointer;">
          <img src="microscopic gifs/location 3 cover image.png" alt="Location 03" style="width:100%;height:100%;object-fit:cover;border-radius:0;">
        </div>
        <div style="margin-top:6px;color:#fff;font-family:'Manofa',Arial,sans-serif;font-size:0.61rem;letter-spacing:0.06em;text-align:center;width:180px;line-height:1.18;">Location 03, Tarmac<br>51.53012, -0.06572</div>
      </div>
      <div style="display:flex;flex-direction:column;align-items:center;margin-bottom:18px;">
        <div class="micro-card" data-index="3" style="width:180px;height:120px;background:white;border-radius:0;box-shadow:0 4px 24px rgba(0,0,0,0.18);display:flex;align-items:center;justify-content:center;cursor:pointer;">
          <img src="microscopic gifs/location 4 cover image.png" alt="Location 04" style="width:100%;height:100%;object-fit:cover;border-radius:0;">
        </div>
        <div style="margin-top:6px;color:#fff;font-family:'Manofa',Arial,sans-serif;font-size:0.61rem;letter-spacing:0.06em;text-align:center;width:180px;line-height:1.18;">Location 04, Slide<br>51.53005, -0.06587</div>
      </div>
      <div style="display:flex;flex-direction:column;align-items:center;margin-bottom:18px;">
        <div class="micro-card" data-index="4" style="width:180px;height:120px;background:white;border-radius:0;box-shadow:0 4px 24px rgba(0,0,0,0.18);display:flex;align-items:center;justify-content:center;cursor:pointer;">
          <img src="microscopic gifs/location 5 cover image.png" alt="Location 05" style="width:100%;height:100%;object-fit:cover;border-radius:0;">
        </div>
        <div style="margin-top:6px;color:#fff;font-family:'Manofa',Arial,sans-serif;font-size:0.61rem;letter-spacing:0.06em;text-align:center;width:180px;line-height:1.18;">Location 05, Bush<br>51.53070, -0.06584</div>
      </div>
      <div style="display:flex;flex-direction:column;align-items:center;margin-bottom:18px;">
        <div class="micro-card" data-index="5" style="width:180px;height:120px;background:white;border-radius:0;box-shadow:0 4px 24px rgba(0,0,0,0.18);display:flex;align-items:center;justify-content:center;cursor:pointer;">
          <img src="microscopic gifs/location 6 cover image.png" alt="Location 06" style="width:100%;height:100%;object-fit:cover;border-radius:0;">
        </div>
        <div style="margin-top:6px;color:#fff;font-family:'Manofa',Arial,sans-serif;font-size:0.61rem;letter-spacing:0.06em;text-align:center;width:180px;line-height:1.18;">Location 06, Tree<br>51.53072, -0.06593</div>
      </div>
      <div style="display:flex;flex-direction:column;align-items:center;margin-bottom:18px;">
        <div class="micro-card" data-index="6" style="width:180px;height:120px;background:white;border-radius:0;box-shadow:0 4px 24px rgba(0,0,0,0.18);display:flex;align-items:center;justify-content:center;cursor:pointer;">
          <img src="microscopic gifs/location 7 cover image.png" alt="Location 07" style="width:100%;height:100%;object-fit:cover;border-radius:0;">
        </div>
        <div style="margin-top:6px;color:#fff;font-family:'Manofa',Arial,sans-serif;font-size:0.61rem;letter-spacing:0.06em;text-align:center;width:180px;line-height:1.18;">Location 07, Tree Trunk Circle<br>51.53026, -0.06688</div>
      </div>
      <div style="display:flex;flex-direction:column;align-items:center;margin-bottom:18px;">
        <div class="micro-card" data-index="7" style="width:180px;height:120px;background:white;border-radius:0;box-shadow:0 4px 24px rgba(0,0,0,0.18);display:flex;align-items:center;justify-content:center;cursor:pointer;">
          <img src="microscopic gifs/location 8 cover image.png" alt="Location 08" style="width:100%;height:100%;object-fit:cover;border-radius:0;">
        </div>
        <div style="margin-top:6px;color:#fff;font-family:'Manofa',Arial,sans-serif;font-size:0.61rem;letter-spacing:0.06em;text-align:center;width:180px;line-height:1.18;">Location 08, Desire Path<br>51.53050, -0.06685</div>
      </div>
      <div style="display:flex;flex-direction:column;align-items:center;margin-bottom:18px;">
        <div class="micro-card" data-index="8" style="width:180px;height:120px;background:white;border-radius:0;box-shadow:0 4px 24px rgba(0,0,0,0.18);display:flex;align-items:center;justify-content:center;cursor:pointer;">
          <img src="microscopic gifs/location 9 cover image.png" alt="Location 09" style="width:100%;height:100%;object-fit:cover;border-radius:0;">
        </div>
        <div style="margin-top:6px;color:#fff;font-family:'Manofa',Arial,sans-serif;font-size:0.61rem;letter-spacing:0.06em;text-align:center;width:180px;line-height:1.18;">Location 09, Exit (left)<br>51.53077, -0.06679</div>
      </div>
      <div style="display:flex;flex-direction:column;align-items:center;margin-bottom:18px;">
        <div class="micro-card" data-index="9" style="width:180px;height:120px;background:white;border-radius:0;box-shadow:0 4px 24px rgba(0,0,0,0.18);display:flex;align-items:center;justify-content:center;cursor:pointer;">
          <img src="microscopic gifs/location 10 cover image.png" alt="Location 10" style="width:100%;height:100%;object-fit:cover;border-radius:0;">
        </div>
        <div style="margin-top:6px;color:#fff;font-family:'Manofa',Arial,sans-serif;font-size:0.61rem;letter-spacing:0.06em;text-align:center;width:180px;line-height:1.18;">Location 10, Exit (right)<br>51.53076, -0.06678</div>
      </div>
    </div>
  </section>

  <!-- Process Images Section -->


  <section id="section-process" style="min-height:100vh;width:100vw;display:flex;flex-direction:column;align-items:center;justify-content:center;scroll-snap-align:start;">
    <div style="padding:32px 24px 32px 24px;max-width:900px;width:95vw;margin:0 auto 32px auto;text-align:center;">
      <h2 style="color:#fff;font-family:'Manofa',Arial,sans-serif;font-size:2rem;margin-bottom:10px;text-align:center;">COLLECTION IMAGES</h2>
      <div style="color:#fff;font-family:'Manofa',Arial,sans-serif;font-size:1.1rem;margin-bottom:24px;text-align:center;letter-spacing:0.06em;max-width:820px;margin-left:auto;margin-right:auto;">
        Images of data collection process.<br>
        10 different audio collection locations were selected.
      </div>
      <div style="max-width:820px;width:100%;margin:0 auto 32px auto;">
        <div style="display:grid;grid-template-columns:repeat(2, 1fr);grid-template-rows:repeat(2, 1fr);gap:2px;width:100%;">
          <div class="collection-img-wrapper" style="position:relative;width:100%;aspect-ratio:1/1;display:flex;align-items:center;justify-content:center;">
            <img class="collection-img" data-index="0" src="collection images/4.1 copy.JPG" alt="Collection Image 1" style="width:90%;height:90%;object-fit:cover;border-radius:0;box-shadow:0 4px 24px rgba(0,0,0,0.18);cursor:pointer;display:block;">
            <div class="collection-img-hover-text" style="position:absolute;top:0;left:0;width:100%;height:100%;display:flex;align-items:center;justify-content:center;opacity:0;transition:opacity 0.3s;background:rgba(0,0,0,0.45);color:#fff;font-family:'Manofa',Arial,sans-serif;font-size:1.1rem;letter-spacing:0.06em;text-align:center;pointer-events:none;border-radius:0;">Audio collection location 4</div>
          </div>
          <div class="collection-img-wrapper" style="position:relative;width:100%;aspect-ratio:1/1;display:flex;align-items:center;justify-content:center;">
            <img class="collection-img" data-index="1" src="collection images/7.2 copy.JPG" alt="Collection Image 2" style="width:90%;height:90%;object-fit:cover;border-radius:0;box-shadow:0 4px 24px rgba(0,0,0,0.18);cursor:pointer;display:block;">
            <div class="collection-img-hover-text" style="position:absolute;top:0;left:0;width:100%;height:100%;display:flex;align-items:center;justify-content:center;opacity:0;transition:opacity 0.3s;background:rgba(0,0,0,0.45);color:#fff;font-family:'Manofa',Arial,sans-serif;font-size:1.1rem;letter-spacing:0.06em;text-align:center;pointer-events:none;border-radius:0;">Audio collection location 8</div>
          </div>
          <div class="collection-img-wrapper" style="position:relative;width:100%;aspect-ratio:1/1;display:flex;align-items:center;justify-content:center;">
            <img class="collection-img" data-index="2" src="collection images/3.5 copy.JPG" alt="Collection Image 3" style="width:90%;height:90%;object-fit:cover;border-radius:0;box-shadow:0 4px 24px rgba(0,0,0,0.18);cursor:pointer;display:block;">
            <div class="collection-img-hover-text" style="position:absolute;top:0;left:0;width:100%;height:100%;display:flex;align-items:center;justify-content:center;opacity:0;transition:opacity 0.3s;background:rgba(0,0,0,0.45);color:#fff;font-family:'Manofa',Arial,sans-serif;font-size:1.1rem;letter-spacing:0.06em;text-align:center;pointer-events:none;border-radius:0;">Audio collection location 3</div>
          </div>
          <div class="collection-img-wrapper" style="position:relative;width:100%;aspect-ratio:1/1;display:flex;align-items:center;justify-content:center;">
            <img class="collection-img" data-index="3" src="collection images/6.2 copy.JPG" alt="Collection Image 4" style="width:90%;height:90%;object-fit:cover;border-radius:0;box-shadow:0 4px 24px rgba(0,0,0,0.18);cursor:pointer;display:block;">
            <div class="collection-img-hover-text" style="position:absolute;top:0;left:0;width:100%;height:100%;display:flex;align-items:center;justify-content:center;opacity:0;transition:opacity 0.3s;background:rgba(0,0,0,0.45);color:#fff;font-family:'Manofa',Arial,sans-serif;font-size:1.1rem;letter-spacing:0.06em;text-align:center;pointer-events:none;border-radius:0;">Audio collection location 6</div>
          </div>
        <style>
          .collection-img-wrapper:hover .collection-img-hover-text {
            opacity: 1 !important;
            pointer-events: auto !important;
          }
        </style>
        </div>
      </div>
    </div>
    <!-- Collection Images Modal Slideshow -->
    <div id="collectionModal" style="display:none;position:fixed;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,0.92);z-index:200010;align-items:center;justify-content:center;flex-direction:column;">
      <button id="closeCollectionModal" type="button" aria-label="Close Collection Modal" style="position:absolute;top:32px;right:48px;font-size:2.2rem;background:none;border:none;color:#fff;cursor:pointer;z-index:200011;">&times;</button>
      <button id="prevCollection" aria-label="Previous Collection Image" style="position:absolute;left:32px;top:50%;transform:translateY(-50%);font-size:2.2rem;background:none;border:none;color:#fff;cursor:pointer;z-index:200011;">&#8592;</button>
      <img id="collectionModalImg" src="collection images/4.1 copy.JPG" alt="Collection Image" style="max-width:90vw;max-height:85vh;border-radius:0;box-shadow:0 4px 32px rgba(0,0,0,0.32);background:#222;">
      <button id="nextCollection" aria-label="Next Collection Image" style="position:absolute;right:32px;top:50%;transform:translateY(-50%);font-size:2.2rem;background:none;border:none;color:#fff;cursor:pointer;z-index:200011;">&#8594;</button>
      <div id="collectionModalCaption" style="margin-top:24px;color:#fff;font-family:'Manofa',Arial,sans-serif;font-size:1.1rem;letter-spacing:0.06em;text-align:center;"></div>
    </div>
    <script>
    // Collection Images Slideshow Logic
    document.addEventListener('DOMContentLoaded', function() {
      const collectionImages = [
        { src: 'collection images/4.1 copy.JPG', caption: 'Collection Image 1' },
        { src: 'collection images/7.2 copy.JPG', caption: 'Collection Image 2' },
        { src: 'collection images/3.5 copy.JPG', caption: 'Collection Image 3' },
        { src: 'collection images/6.2 copy.JPG', caption: 'Collection Image 4' }
      ];
      let collectionIndex = 0;
      const collectionModal = document.getElementById('collectionModal');
      const collectionModalImg = document.getElementById('collectionModalImg');
      const collectionModalCaption = document.getElementById('collectionModalCaption');
      const btnCloseCollectionModal = document.getElementById('closeCollectionModal');
      const btnPrevCollection = document.getElementById('prevCollection');
      const btnNextCollection = document.getElementById('nextCollection');
      function showCollection(idx) {
        collectionIndex = (idx + collectionImages.length) % collectionImages.length;
        collectionModalImg.src = collectionImages[collectionIndex].src;
        // Match hover style and content for modal title
        const hoverText = document.querySelectorAll('.collection-img-hover-text')[collectionIndex]?.textContent || collectionImages[collectionIndex].caption;
        collectionModalCaption.textContent = hoverText;
      }
      document.querySelectorAll('.collection-img-wrapper').forEach(function(wrapper) {
        wrapper.addEventListener('click', function(e) {
          var img = wrapper.querySelector('.collection-img');
          if (!img) return;
          const idx = parseInt(img.getAttribute('data-index'), 10);
          if (!isNaN(idx)) {
            collectionModal.style.display = 'flex';
            showCollection(idx);
          }
        });
      });
      if (btnCloseCollectionModal && collectionModal) {
        btnCloseCollectionModal.addEventListener('click', function() {
          collectionModal.style.display = 'none';
        });
        collectionModal.addEventListener('click', function(e) {
          if (e.target === collectionModal) collectionModal.style.display = 'none';
        });
      }
      if (btnPrevCollection) {
        btnPrevCollection.addEventListener('click', function() {
          showCollection(collectionIndex - 1);
        });
      }
      if (btnNextCollection) {
        btnNextCollection.addEventListener('click', function() {
          showCollection(collectionIndex + 1);
        });
      }
    });
    </script>
    </div>
  </section>

  <!-- Card Stack Section (moved) -->

  <!-- Investigation Files Modal Overlay -->
  <div id="investigationModal" class="overlay-fullscreen" style="display:none;z-index:30010;flex-direction:column;align-items:center;justify-content:center;overflow:auto;">
    <button id="closeInvestigationModal" type="button" aria-label="Close Investigation Modal" style="position:absolute;top:32px;right:48px;font-size:2.2rem;background:none;border:none;color:#fff;cursor:pointer;z-index:30011;">&times;</button>
    <div style="display:flex;flex-direction:column;align-items:center;justify-content:flex-start;min-height:100vh;width:100vw;padding-bottom:80px;">
      <div class="container" id="cardContainer" style="position:relative;z-index:30012;margin-top:48px;">
      <!-- Arrow button will be injected into expanded card dynamically -->
      <div class="card card1"><img src="images for cards/page 1.png?v=20260102" alt="Page 1" style="width:100%;height:100%;object-fit:contain;object-position:top;"></div>
      <div class="card card2"><img src="images for cards/page 2.png" alt="Page 2" style="width:100%;height:100%;object-fit:contain;object-position:top;"></div>
      <div class="card card3"><img src="images for cards/page 3.png" alt="Page 3" style="width:100%;height:100%;object-fit:contain;object-position:top;"></div>
      <div class="card card4"><img src="images for cards/page 4.png" alt="Page 4" style="width:100%;height:100%;object-fit:contain;object-position:top;"></div>
      <div class="card translucent translucent1"><img src="images for cards/translucent page 1.png" alt="Translucent Page 1" style="width:100%;height:100%;object-fit:contain;object-position:top;"></div>
      <div class="card card5"><img src="images for cards/page 5.png" alt="Page 5" style="width:100%;height:100%;object-fit:contain;object-position:top;"></div>
      <div class="card translucent translucent2"><img src="images for cards/translucent page 2.png" alt="Translucent Page 2" style="width:100%;height:100%;object-fit:contain;object-position:top;"></div>
      <div class="card card6"><img src="images for cards/page 6.png" alt="Page 6" style="width:100%;height:100%;object-fit:contain;object-position:top;"></div>
      <div class="card card7"><img src="images for cards/page 7.png" alt="Page 7" style="width:100%;height:100%;object-fit:contain;object-position:top;"></div>
      </div>
    </div>
  </div>

  <!-- Dummy anchor for smooth scroll compatibility -->
  <section id="section-cards" style="min-height:100vh;width:100vw;display:flex;align-items:center;justify-content:center;">
    <div style="width:100vw;display:flex;flex-direction:column;align-items:center;justify-content:center;">
      <h2 style="color:#fff;font-family:'Manofa',Arial,sans-serif;font-size:2rem;margin-bottom:10px;text-align:center;width:100vw;">INVESTIGATION FILES</h2>
      <div style="color:#fff;font-family:'Manofa',Arial,sans-serif;font-size:1.05rem;margin-bottom:12px;text-align:center;letter-spacing:0.06em;max-width:700px;">Please click below to open investigation project files.</div>
      <div style="display:flex;flex-direction:column;align-items:center;justify-content:center;">
        <button id="openInvestigationModalBtn" style="background:none;border:none;padding:0;cursor:pointer;box-shadow:none;outline:none;display:flex;flex-direction:column;align-items:center;justify-content:center;" aria-label="Open Investigation Files Modal">
          <div style="position:relative;width:320px;height:420px;max-width:80vw;">
            <img src="images for cards/page 1.png" alt="Card 1" style="position:absolute;left:0;top:0;width:100%;height:100%;z-index:3;box-shadow:0 8px 32px rgba(0,0,0,0.22);border-radius:0;">
            <img src="images for cards/page 2.png" alt="Card 2" style="position:absolute;left:18px;top:18px;width:100%;height:100%;z-index:2;opacity:0.85;filter:blur(0.5px);box-shadow:0 4px 24px rgba(0,0,0,0.16);border-radius:0;">
            <img src="images for cards/translucent page 1.png" alt="Translucent Card" style="position:absolute;left:36px;top:36px;width:100%;height:100%;z-index:1;opacity:0.7;filter:blur(1px);box-shadow:0 2px 12px rgba(0,0,0,0.10);border-radius:0;">
          </div>
        </button>
      </div>
    </div>
  </section>
    <script>
    // Open modal from button in scrollable navigation
    document.addEventListener('DOMContentLoaded', function() {
      const openBtn = document.getElementById('openInvestigationModalBtn');
      const investigationModal = document.getElementById('investigationModal');
      function hideInvestigationTitle() {
        var title = document.getElementById('investigationTitle');
        if (title) title.style.display = 'none';
      }
      function showInvestigationTitle() {
        var title = document.getElementById('investigationTitle');
        if (title) title.style.display = '';
      }
      function hideMainTitle() {
        var mainTitle = document.getElementById('mainTitle');
        if (mainTitle) mainTitle.style.opacity = '0';
      }
      function showMainTitle() {
        var mainTitle = document.getElementById('mainTitle');
        if (mainTitle) mainTitle.style.opacity = '1';
      }
      if (openBtn && investigationModal) {
        openBtn.addEventListener('click', function(e) {
          e.preventDefault();
          investigationModal.style.display = 'flex';
          setTimeout(() => { investigationModal.style.opacity = '1'; }, 10);
          hideInvestigationTitle();
          hideMainTitle();
        });
      }
    });
    </script>
  <script>
  // Investigation Files Modal Logic
  document.addEventListener('DOMContentLoaded', function() {
    const investigationModal = document.getElementById('investigationModal');
    const closeInvestigationModal = document.getElementById('closeInvestigationModal');
    const cardsBtn = document.getElementById('cardsBtn');
    // Scroll to section-cards when sidebar button is clicked
    if (cardsBtn) {
      cardsBtn.addEventListener('click', function(e) {
        e.preventDefault();
        const section = document.getElementById('section-cards');
        if (section) {
          section.scrollIntoView({ behavior: 'smooth' });
        }
      });
    }
    // Close modal logic
    function closeModal() {
      if (investigationModal) {
        investigationModal.style.opacity = '0';
        setTimeout(() => { investigationModal.style.display = 'none'; showInvestigationTitle(); showMainTitle(); }, 400);
      }
    }
    if (closeInvestigationModal) {
      closeInvestigationModal.addEventListener('click', function(e) {
        e.stopPropagation();
        closeModal();
      });
    }
    // Click outside card container closes modal
    if (investigationModal) {
      investigationModal.addEventListener('mousedown', function(e) {
        const cardContainer = document.getElementById('cardContainer');
        if (e.target === investigationModal && cardContainer && !cardContainer.contains(e.target)) {
          closeModal();
        }
      });
    }
    // Escape key closes modal
    document.addEventListener('keydown', function(e) {
      if (investigationModal && investigationModal.style.display === 'flex') {
        if (e.key === 'Escape') closeModal();
      }
    });
  });
  </script>

  <!-- Download PDF Section -->
  <section id="section-download" style="min-height:100vh;width:100vw;display:flex;flex-direction:column;align-items:center;justify-content:center;scroll-snap-align:start;">
    <div style="padding:32px 24px 32px 24px;max-width:700px;width:90vw;margin:0 auto 32px auto;text-align:center;">
      <h2 style="color:#fff;font-family:'Manofa',Arial,sans-serif;font-size:2rem;margin-bottom:18px;text-align:center;">DOWNLOAD PDF</h2>
      <div style="color:#fff;font-family:'Manofa',Arial,sans-serif;font-size:1.1rem;margin-bottom:32px;text-align:center;letter-spacing:0.06em;">Click the button below to download the full project PDF.</div>
      <a href="pdf/UNHEARDandUNSEEN.pdf" download style="font-family:'Manofa',Arial,sans-serif;font-size:1.2rem;letter-spacing:0.08em;text-transform:uppercase;background:#fff;color:#181818;padding:16px 36px;border-radius:0;box-shadow:0 4px 24px rgba(0,0,0,0.18);text-decoration:none;transition:background 0.2s,color 0.2s;display:inline-block;">Download PDF</a>
    </div>
  </section>
      <!-- Microscopic Images Modal (Fresh) -->
      <div id="microscopicModal" style="display:none;position:fixed;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,0.92);z-index:100010;align-items:center;justify-content:center;flex-direction:column;">
        <button id="closeMicroscopicModal" type="button" aria-label="Close Microscopic Modal" style="position:absolute;top:32px;right:48px;font-size:2.2rem;background:none;border:none;color:#fff;cursor:pointer;z-index:100011;">&times;</button>
        <button id="prevMicroscopicModal" type="button" aria-label="Previous Microscopic Image" style="position:absolute;left:32px;top:50%;transform:translateY(-50%);font-size:2.2rem;background:none;border:none;color:#fff;cursor:pointer;z-index:100011;">&#8592;</button>
        <div style="display:flex;flex-direction:row;align-items:center;justify-content:center;width:100%;height:100%;">
          <img id="microscopicModalImg" src="" alt="Microscopic Image" style="width:700px;height:400px;object-fit:cover;border-radius:0;box-shadow:0 4px 32px rgba(0,0,0,0.32);background:transparent;">
        </div>
        <button id="nextMicroscopicModal" type="button" aria-label="Next Microscopic Image" style="position:absolute;right:32px;top:50%;transform:translateY(-50%);font-size:2.2rem;background:none;border:none;color:#fff;cursor:pointer;z-index:100011;">&#8594;</button>
        <div id="microscopicModalCaption" style="margin-top:24px;color:#fff;font-family:'Manofa',Arial,sans-serif;font-size:1.1rem;letter-spacing:0.08em;text-align:center;"></div>
        <div id="microscopicModalSection" style="margin-top:8px;color:#fff;font-family:'Manofa',Arial,sans-serif;font-size:1.1rem;letter-spacing:0.06em;text-align:center;"></div>
      </div>
      // --- Microscopic Slideshow Logic ---
      <script>
      document.addEventListener('DOMContentLoaded', function() {
        const images = [
          { still: 'microscopic gifs/location 1 cover image.png', gif: 'microscopic gifs/location 1 gif new.gif', caption: 'Location 01, Grass, 51.53036, -0.06603' },
          { still: 'microscopic gifs/location 2 cover image.png', gif: 'microscopic gifs/location 2 new gif.gif', caption: 'Location 02, Metal Park Bench, 51.53035, -0.06604' },
          { still: 'microscopic gifs/location 3 cover image.png', gif: 'microscopic gifs/location 3 new gif.gif', caption: 'Location 03, Tarmac, 51.53012, -0.06572' },
          { still: 'microscopic gifs/location 4 cover image.png', gif: 'microscopic gifs/location 4 new gif.gif', caption: 'Location 04, Slide, 51.53005, -0.06587' },
          { still: 'microscopic gifs/location 5 cover image.png', gif: 'microscopic gifs/location 5 new gif.gif', caption: 'Location 05, Bush, 51.53070, -0.06584' },
          { still: 'microscopic gifs/location 6 cover image.png', gif: 'microscopic gifs/location 6 new gif.gif', caption: 'Location 06, Tree, 51.53072, -0.06593' },
          { still: 'microscopic gifs/location 7 cover image.png', gif: 'microscopic gifs/location 7 new gif.gif', caption: 'Location 07, Tree Trunk Circle, 51.53026, -0.06688' },
          { still: 'microscopic gifs/location 8 cover image.png', gif: 'microscopic gifs/location 8 new gif.gif', caption: 'Location 08, Desire Path, 51.53050, -0.06685' },
          { still: 'microscopic gifs/location 9 cover image.png', gif: 'microscopic gifs/location 9 new gif.gif', caption: 'Location 09, Exit (left), 51.53077, -0.06679' },
          { still: 'microscopic gifs/location 10 cover image.png', gif: 'microscopic gifs/location 10 new gif.gif', caption: 'Location 10, Exit (right), 51.53076, -0.06678' }
        ];
        let current = 0;
        const grid = document.getElementById('microscopicGrid');
        const modal = document.getElementById('microscopicModal');
        const img = document.getElementById('microscopicModalImg');
        const caption = document.getElementById('microscopicModalCaption');
        const section = document.getElementById('microscopicModalSection');
        const btnClose = document.getElementById('closeMicroscopicModal');
        const btnPrev = document.getElementById('prevMicroscopicModal');
        const btnNext = document.getElementById('nextMicroscopicModal');
        // Always show grid in section unless modal is open
        if (grid) grid.style.display = 'grid';
        function showModal(idx) {
          current = (idx + images.length) % images.length;
          // Use GIF if available, otherwise still
          if (images[current].gif) {
            img.src = images[current].gif;
          } else {
            img.src = images[current].still;
          }
          // Match hover style and content for modal title
          caption.textContent = images[current].caption.split(',')[0];
          section.textContent = images[current].caption.replace(images[current].caption.split(',')[0] + ',', '').trim();
          modal.style.display = 'flex';
          // Make modal image fill most of the screen, but not all
          img.style.width = '80vw';
          img.style.height = '80vh';
          img.style.objectFit = 'contain';
          img.style.maxWidth = '80vw';
          img.style.maxHeight = '80vh';
          if (grid) grid.style.display = 'none';
          // --- Audio sync logic ---
          var audio = document.getElementById('bgAudio');
          if (audio) {
            var segment = current * 20;
            audio.currentTime = segment;
            audio.play().catch(function(){});
            // Loop audio and GIF every 20s
            if (window._gifAudioLoop) clearInterval(window._gifAudioLoop);
            window._gifAudioLoop = setInterval(function() {
              if (modal.style.display === 'flex') {
                audio.currentTime = segment;
                audio.play().catch(function(){});
                // Reload GIF to restart animation
                if (images[current].gif) {
                  img.src = '';
                  setTimeout(function() { img.src = images[current].gif; }, 50);
                }
              } else {
                clearInterval(window._gifAudioLoop);
              }
            }, 20000);
          }
        }
        // Open modal on card click
        if (grid) {
          grid.addEventListener('click', function(e) {
            const card = e.target.closest('.micro-card');
            if (card) {
              const idx = parseInt(card.getAttribute('data-index'));
              if (!isNaN(idx)) showModal(idx);
            }
          });
        }
        // Navigation
        if (btnPrev && !btnPrev._handlerAttached) {
          btnPrev.addEventListener('click', function(e) {
            e.stopPropagation();
            console.log('Prev arrow clicked, current:', current);
            showModal(current - 1);
          });
          btnPrev._handlerAttached = true;
        }
        if (btnNext) btnNext.addEventListener('click', function(e) {
          e.stopPropagation();
          showModal(current + 1);
        });
        if (btnClose) btnClose.addEventListener('click', function(e) {
          e.stopPropagation();
          modal.style.display = 'none';
          if (grid) grid.style.display = 'grid';
          var audio = document.getElementById('bgAudio');
          if (audio) audio.pause();
          if (window._gifAudioLoop) clearInterval(window._gifAudioLoop);
        });
        // Click outside image closes modal
        if (modal) modal.addEventListener('mousedown', function(e) {
          if (e.target === modal) {
            modal.style.display = 'none';
            if (grid) grid.style.display = 'grid';
            var audio = document.getElementById('bgAudio');
            if (audio) audio.pause();
            if (window._gifAudioLoop) clearInterval(window._gifAudioLoop);
          }
        });
        // Keyboard navigation
        document.addEventListener('keydown', function(e) {
          if (modal && modal.style.display === 'flex') {
            if (e.key === 'ArrowLeft') showModal(current - 1);
            else if (e.key === 'ArrowRight') showModal(current + 1);
            else if (e.key === 'Escape') {
              modal.style.display = 'none';
              if (grid) grid.style.display = 'grid';
              var audio = document.getElementById('bgAudio');
              if (audio) audio.pause();
            }
          }
        });
      });
      </script>
      /* Removed legacy microscopicSlideshow keyboard navigation and unused script/styles */
  <style>
    .main-section {
      width: 100%;
      max-width: 1200px;
      margin-left: auto;
      margin-right: auto;
    }
    .map-modal-btn {
      background: none;
      border: none;
      padding: 0;
      margin: 0;
      cursor: pointer;
      box-shadow: none;
      display: flex;
      align-items: center;
      justify-content: center;
      width: 210px;
      height: 262.5px;
    }
    .map-modal-img {
      width: 210px;
      height: 262.5px;
      object-fit: contain;
      display: block;
      border-radius: 0;
      box-shadow: 0 16px 48px 0 rgba(0,0,0,0.55), 0 2px 12px 0 rgba(0,0,0,0.18);
    }
    html {
      scroll-padding-top: 80px;
    }
    html, body {
      scroll-behavior: smooth;
      scroll-snap-type: y mandatory;
    }
    section {
      scroll-snap-align: start;
      min-height: 100vh;
      width: 100vw;
      box-sizing: border-box;
    }
    .card.translucent {
      opacity: 0.7;
      transition: opacity 0.3s;
    }
    .card.translucent.expanded {
      opacity: 1 !important;
    }
    .overlay-card {
      position: fixed;
      left: 50%;
      top: 50%;
      width: 600px;
      height: 780px;
      background: white;
      border-radius: 0;
      box-shadow: 0 40px 80px rgba(0,0,0,0.7);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2rem;
      font-family: 'Manofa', Arial, sans-serif;
      z-index: 20000;
      cursor: pointer;
      transition: opacity 0.4s, transform 0.45s cubic-bezier(.2,.9,.2,1);
      opacity: 1;
      pointer-events: auto;
      transform: translate(-50%, -50%) translateZ(220px) rotateY(0deg) rotateX(0deg) scale(1);
      text-align: center;
      overflow: hidden;
      position: fixed;
    }
    .overlay-card img {
      width: 100%;
      height: 100%;
      object-fit: contain;
      display: block;
    }
    .overlay-card span {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: #222;
      font-size: 1.2rem;
      font-family: 'Manofa', Arial, sans-serif;
      background: rgba(255,255,255,0.7);
      padding: 8px 16px;
      border-radius: 6px;
    }
    .overlay-card.hide {
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.4s;
    }
  </style>
  <script>
    function updateInvestigationTitles() {
      var title = document.getElementById('investigationTitle');
      var mainTitle = document.getElementById('mainTitle');
      var anyExpanded = !!document.querySelector('.card.expanded');
      if (title) title.style.display = anyExpanded ? 'none' : '';
      if (mainTitle) mainTitle.style.opacity = anyExpanded ? '0' : '1';
    }
    window.addEventListener('DOMContentLoaded', function() {
      const investigationModal = document.getElementById('investigationModal');
      const cards = document.querySelectorAll('.card');
      let expandedCard = null;
      let nextCardBtn = null;
      function isModalOpen() {
        return investigationModal && investigationModal.style.display === 'flex';
      }
      function resetCard(c) {
        c.classList.remove('active', 'expanded', 'inactive');
        c.style.transition = '';
        c.style.transform = '';
        c.style.zIndex = '';
        c.style.boxShadow = '';
        c.style.position = '';
        c.style.left = '';
        c.style.top = '';
        c.style.width = '';
        c.style.height = '';
        // Remove arrow if present
        if (nextCardBtn && nextCardBtn.parentNode) {
          nextCardBtn.parentNode.removeChild(nextCardBtn);
        }
      }
      function expandCard(card) {
          updateInvestigationTitles();
          updateInvestigationTitles();
        cards.forEach(c => {
          c.classList.remove('active', 'expanded', 'inactive');
          c.style.transition = '';
          c.style.transform = '';
          c.style.position = '';
          c.style.left = '';
          c.style.top = '';
          c.style.width = '';
          c.style.height = '';
          c.style.zIndex = '';
          c.style.boxShadow = '';
          if (c.classList.contains('translucent')) {
            c.style.opacity = '';
          }
        });
        card.classList.add('active', 'expanded');
        card.style.zIndex = 100;
        card.style.boxShadow = '0 40px 80px rgba(0,0,0,0.7)';
        card.style.position = 'fixed';
        card.style.left = '50%';
        card.style.top = '60px';
        card.style.width = '800px';
        card.style.height = '1040px';
        card.style.transform = 'translateX(-50%) translateZ(220px)';
        if (card.classList.contains('translucent')) {
          card.style.opacity = '1';
        }
        // Add next arrow if not last card
        const idx = Array.from(cards).indexOf(card);
        if (idx < cards.length - 1) {
          if (!nextCardBtn) {
            nextCardBtn = document.createElement('button');
            nextCardBtn.id = 'nextCardBtn';
            nextCardBtn.innerHTML = '&#8594;';
            nextCardBtn.style.position = 'absolute';
            nextCardBtn.style.right = '-48px';
            nextCardBtn.style.top = '50%';
            nextCardBtn.style.transform = 'translateY(-50%)';
            nextCardBtn.style.fontSize = '2.2rem';
            nextCardBtn.style.background = '#111';
            nextCardBtn.style.color = '#fff';
            nextCardBtn.style.border = 'none';
            nextCardBtn.style.borderRadius = '50%';
            nextCardBtn.style.padding = '0';
            nextCardBtn.style.width = '48px';
            nextCardBtn.style.height = '48px';
            nextCardBtn.style.display = 'flex';
            nextCardBtn.style.alignItems = 'center';
            nextCardBtn.style.justifyContent = 'center';
            nextCardBtn.style.cursor = 'pointer';
            nextCardBtn.style.boxShadow = '0 2px 12px rgba(0,0,0,0.18)';
            nextCardBtn.style.zIndex = '20001';
          }
          card.appendChild(nextCardBtn);
          nextCardBtn.style.display = 'block';
          if (!nextCardBtn._handlerAttached) {
            nextCardBtn.addEventListener('click', function(e) {
              e.stopPropagation();
              if (!expandedCard) return;
              const idx = Array.from(cards).indexOf(expandedCard);
              if (idx < cards.length - 1) {
                resetCard(expandedCard);
                expandCard(cards[idx + 1]);
                expandedCard = cards[idx + 1];
                setTimeout(updateInvestigationTitles, 0);
              }
            });
            nextCardBtn._handlerAttached = true;
          }
        } else if (nextCardBtn && nextCardBtn.parentNode) {
          nextCardBtn.parentNode.removeChild(nextCardBtn);
        }
      }
      cards.forEach(card => {
        card.addEventListener('click', (e) => {
          if (!isModalOpen()) return;
          setTimeout(updateInvestigationTitles, 0);
          e.stopPropagation();
          if (expandedCard === card) {
            resetCard(card);
            expandedCard = null;
            cards.forEach(c => c.classList.remove('inactive'));
            return;
          }
          if (expandedCard) {
            resetCard(expandedCard);
            expandedCard = null;
          }
          expandCard(card);
          expandedCard = card;
        });
      });
      if (nextCardBtn && !nextCardBtn._handlerAttached) {
        nextCardBtn.addEventListener('click', function(e) {
          e.stopPropagation();
          if (!expandedCard) return;
          const idx = Array.from(cards).indexOf(expandedCard);
          if (idx < cards.length - 1) {
            resetCard(expandedCard);
            expandCard(cards[idx + 1]);
            expandedCard = cards[idx + 1];
          }
        });
        nextCardBtn._handlerAttached = true;
      }
      // Clicking anywhere else closes the expanded card
      document.addEventListener('click', function(e) {
        if (!isModalOpen()) return;
        setTimeout(updateInvestigationTitles, 0);
        if (expandedCard) {
          const isCard = e.target.classList && e.target.classList.contains('card');
          const isArrow = e.target.id === 'nextCardBtn';
          if (!isCard && !isArrow) {
            resetCard(expandedCard);
            expandedCard = null;
            cards.forEach(c => c.classList.remove('inactive'));
          }
        }
      });
    });
    /* ...existing code... */
  </script>
  <style>
    .card1 {
      background: transparent;
    }
    .card1.expanded {
      background: white;
    }
  </style>
  <script>
document.addEventListener('DOMContentLoaded', function() {
  var openMapModalBtn = document.getElementById('openMapModalBtn');
  var mapModal = document.getElementById('mapModal');
  var closeMapModal = document.getElementById('closeMapModal');
  function openModal() {
    if (mapModal) {
      mapModal.style.display = 'flex';
      document.body.style.overflow = 'hidden';
      var instr = document.getElementById('mapInstructionCircle');
      if (instr) instr.style.display = 'flex';
    }
  }
  function closeModal() {
    if (mapModal) {
      mapModal.style.display = 'none';
      document.body.style.overflow = '';
      var instr = document.getElementById('mapInstructionCircle');
      if (instr) instr.style.display = 'none';
    }
  }
  if (openMapModalBtn) {
    openMapModalBtn.addEventListener('click', openModal);
  }
  if (closeMapModal) {
    closeMapModal.addEventListener('click', closeModal);
  }
  if (mapModal) {
    mapModal.addEventListener('click', function(e) {
      if (e.target === mapModal) closeModal();
    });
  }
});
</script>
<script>
document.addEventListener('DOMContentLoaded', function() {
  var mapModal = document.getElementById('mapModal');
  var mainTitle = document.getElementById('mainTitle');
  var openMapModalBtn = document.getElementById('openMapModalBtn');
  var closeMapModal = document.getElementById('closeMapModal');
  var sectionMap = document.getElementById('section-map');
  var microscopicModal = document.getElementById('microscopicModal');
  let mapModalOpen = false;
  let microscopicModalOpen = false;

  function hideMainTitle() {
    if (mainTitle) mainTitle.style.opacity = '0';
  }
  function showMainTitle() {
    if (mainTitle) mainTitle.style.opacity = '1';
  }
  function showMainTitleIfNotMap() {
    // Show if map section is in view and modal is not open, or if not in map section and no modals open
    if (!mapModalOpen && mainTitle && isMapSectionInView()) {
      mainTitle.style.opacity = '1';
    } else if (!mapModalOpen && !microscopicModalOpen && mainTitle && !isMapSectionInView()) {
      mainTitle.style.opacity = '1';
    } else {
      hideMainTitle();
    }
  }
  function isMapSectionInView() {
    if (!sectionMap) return false;
    const rect = sectionMap.getBoundingClientRect();
    return (
      rect.top < window.innerHeight &&
      rect.bottom > 0
    );
  }
  if (openMapModalBtn) {
    openMapModalBtn.addEventListener('click', function() {
      mapModalOpen = true;
      hideMainTitle();
    });
  }
  if (closeMapModal) {
    closeMapModal.addEventListener('click', function() {
      mapModalOpen = false;
      showMainTitleIfNotMap();
    });
  }
  if (mapModal) {
    mapModal.addEventListener('click', function(e) {
      if (e.target === mapModal) {
        mapModalOpen = false;
        showMainTitleIfNotMap();
      }
    });
  }
  // Microscopic modal open/close logic
  if (microscopicModal) {
    // Open: listen for style.display change to 'flex'
    const observer = new MutationObserver(function() {
      if (microscopicModal.style.display === 'flex') {
        microscopicModalOpen = true;
        hideMainTitle();
      } else {
        microscopicModalOpen = false;
        showMainTitleIfNotMap();
      }
    });
    observer.observe(microscopicModal, { attributes: true, attributeFilter: ['style'] });
  }
  window.addEventListener('scroll', function() {
    showMainTitleIfNotMap();
  });
  // Also hide title on any click while a modal is open (for edge cases)
  document.addEventListener('click', function() {
    if (mapModalOpen || microscopicModalOpen) hideMainTitle();
  }, true);
});
</script>
</body>
</html>
